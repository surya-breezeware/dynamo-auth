import{__rest as e,__awaiter as i}from"tslib";import o,{forwardRef as r,useMemo as t,useState as l,useEffect as a}from"react";import n from"maplibre-gl";import{AmplifyMapLibreRequest as m}from"maplibre-gl-js-amplify";import s from"react-map-gl";import{Amplify as p,Auth as v}from"aws-amplify";const f=r(((r,f)=>{var c,{mapLib:d,mapStyle:u,style:g}=r,y=e(r,["mapLib","mapStyle","style"]);const b=p.configure(),w=t((()=>{var e,i,o,r;return null!==(r=null!==(i=null===(e=b.geo)||void 0===e?void 0:e.amazon_location_service)&&void 0!==i?i:null===(o=b.geo)||void 0===o?void 0:o.AmazonLocationService)&&void 0!==r?r:{}}),[b]),[h,L]=l(),S=t((()=>Object.assign({height:"100vh",position:"relative",width:"100vw"},g)),[g]);return a((()=>{i(void 0,void 0,void 0,(function*(){const e=yield v.currentUserCredentials();if(e){const{region:i}=w,{transformRequest:o}=new m(e,i);L((()=>o))}}))}),[w]),h?o.createElement(s,Object.assign({},y,{mapLib:null!=d?d:n,mapStyle:null!=u?u:null===(c=w.maps)||void 0===c?void 0:c.default,ref:f,style:S,transformRequest:h,fog:y.fog,terrain:y.terrain})):null}));f.displayName="MapView";export{f as MapView};
